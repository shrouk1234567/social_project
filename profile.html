
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Profile</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div class="container" style="max-width:720px;margin-top:20px;">
  <div class="card">
    <h3>Edit profile</h3>
    <input id="pf-name" class="input" placeholder="Name">
    <input id="pf-email" class="input" placeholder="Email">
    <textarea id="pf-bio" class="input" rows="3" placeholder="Bio"></textarea>
    <div style="text-align:right;margin-top:8px;">
      <button class="btn" id="btn-update-profile">Save</button>
    </div>
  </div>
</div>
<script>
const API = "https://tarmeezacademy.com/api/v1";

async function loadProfile(){
  const user = JSON.parse(localStorage.getItem("user"));
  if(!user) return;

  document.getElementById("pf-name").value  = user.name  || "";
  document.getElementById("pf-email").value = user.email || "";
  document.getElementById("pf-bio").value   = user.bio   || "";
}

document.getElementById("btn-update-profile").addEventListener("click", async ()=>{
  const name  = document.getElementById("pf-name").value.trim();
  const email = document.getElementById("pf-email").value.trim();
  const bio   = document.getElementById("pf-bio").value.trim();

  const user = JSON.parse(localStorage.getItem("user"));
  if(!user || !user.token) return alert("You must login first!");

  try {
    const res = await fetch(`${API}/updateProfile`, {
      method:"PUT",
      headers:{
        "Accept":"application/json",
        "Content-Type":"application/json",
        "Authorization": `Bearer ${user.token}`
      },
      body: JSON.stringify({ name, email, bio })
    });

    const data = await res.json();

    if(res.ok){
      // update local storage
      localStorage.setItem("user", JSON.stringify(data.data.user));
      alert("Profile updated!");
    } else {
      alert(data.message || "Update failed");
    }

  } catch(err){
    console.error(err);
    alert("Update failed");
  }
});

loadProfile();
</script>

</body>
</html>





























