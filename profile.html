
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Profile</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div class="container" style="max-width:720px;margin-top:20px;">
  <div class="card">
    <h3>Edit profile</h3>
    <input id="pf-name" class="input" placeholder="Name">
    <input id="pf-email" class="input" placeholder="Email">
    <textarea id="pf-bio" class="input" rows="3" placeholder="Bio"></textarea>
    <div style="text-align:right;margin-top:8px;">
      <button class="btn" id="btn-update-profile">Save</button>
    </div>
  </div>
</div>
<script>
const API = "https://tarmeezacademy.com/api/v1";

async function loadProfile(){
  const user = JSON.parse(localStorage.getItem("user"));
  if(!user) return;

  document.getElementById("pf-name").value  = user.name  || "";
  document.getElementById("pf-email").value = user.email || "";
  document.getElementById("pf-bio").value   = user.bio   || "";
}

document.getElementById("btn-update-profile").addEventListener("click", async ()=>{
  const name  = document.getElementById("pf-name").value.trim();
  const email = document.getElementById("pf-email").value.trim();
  const bio   = document.getElementById("pf-bio").value.trim();

  const user = JSON.parse(localStorage.getItem("user"));
  if(!user || !user.token) return alert("You must login first!");

  try {
    const res = await fetch(`${API}/updateProfile`, {
      method:"PUT",
      headers:{
        "Accept":"application/json",
        "Content-Type":"application/json",
        "Authorization": `Bearer ${user.token}`
      },
      body: JSON.stringify({ name, email, bio })
    });

    const data = await res.json();

    if(res.ok){
      // update local storage
      localStorage.setItem("user", JSON.stringify(data.data.user));
      alert("Profile updated!");
    } else {
      alert(data.message || "Update failed");
    }

  } catch(err){
    console.error(err);
    alert("Update failed");
  }
});

loadProfile();
</script>

</body>
</html>






























<!--<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Profile</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container" >
    <a href="index.html">‚Üê Back</a>
    <div class="card">
      <h3>Edit profile</h3>
      <input id="pf-name" class="input" placeholder="Name">
      <input id="pf-email" class="input" placeholder="Email">
      <textarea id="pf-bio" class="input" rows="3" placeholder="Bio"></textarea>
      <div style="text-align:right;margin-top:8px"><button class="btn" id="btn-update-profile">Save</button></div>
    </div>
  </div>

  <script src="app.js"></script>
  <script>
    async function loadProfile(){
      try{
        // Attempt to get current user via stored user; otherwise fetch users
        const stored = localStorage.getItem('user');
        if(stored){
          const u = JSON.parse(stored);
          document.getElementById('pf-name').value = u.name || '';
          document.getElementById('pf-email').value = u.email || '';
          document.getElementById('pf-bio').value = u.bio || '';
          return;
        }
        const users = await api.getUsers();
        if(Array.isArray(users) && users[0]){
          document.getElementById('pf-name').value = users[0].name || '';
          document.getElementById('pf-email').value = users[0].email || '';
        }
      }catch(e){ console.error(e); }
    }

    document.getElementById('btn-update-profile').addEventListener('click', async ()=>{
      const name = document.getElementById('pf-name').value.trim();
      const email = document.getElementById('pf-email').value.trim();
      const bio = document.getElementById('pf-bio').value.trim();
      try{ await api.updateProfile({ name, email, bio }); alert('Profile updated'); }catch(e){ console.error(e); alert('Fail update'); }
    });

    loadProfile();
  </script>
</body>
</html>-->